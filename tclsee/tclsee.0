/*-------------------------------------------------------------------------- 
 *                         Interpreter Interface
 *
 * ::see::interp
 *     Create a new SEE interpreter and return it's name (which may
 *     then be used as a Tcl command). Interpreter command names are
 *     always generated by this code, they can be renamed if required. 
 *
 *
 * $interp destroy
 *     Delete an interpreter and all associated resources. The command
 *     $interp is deleted by this command.
 *
 * $interp global TCL-OBJECT
 *     Install the javascript wrapper of TCL-OBJECT as the global
 *     interpreter object. In web-browsers this is the Window object.
 *
 * $interp eval ?-file FILENAME? JAVASCRIPT
 *     Evaluate the supplied javascript using SEE_Global_eval().
 *
 * $interp tostring OBJ
 *     Return the string form of a javascript object.
 *
 * $interp debug objects
 *     Return a list of Tcl commands this interpreter is holding
 *     as persistent-state objects.
 */

/*------------------------------------------------------------------------
 *                         Javascript values:
 *
 *     undefined
 *     null
 *     boolean    BOOL
 *     number     NUMBER
 *     string     STRING
 *     object     COMMAND
 *     transient  COMMAND
 *
 */

/*-------------------------------------------------------------------------- 
 *                      Tcl-based Javascript Objects
 *
 * As well as running javascript code, the Tcl application must provide
 * implementations of DOM objects to the javascript interpreter. Objects
 * are provided by one of two methods:
 *
 *     1) Explicitly, by calling the [$interp global] command.
 *
 *     2) By returning a value of the form {object OBJ} or {transient OBJ}
 *        from a [Call], [Construct] or [Get] invocation on another object
 *        (see below).
 *
 * In either case, the Tcl application provides the interpreter with a
 * command that supports the following interface:
 *
 *         $obj Call         THIS ?ARG-VALUE...?
 *         $obj CanPut       PROPERTY
 *         $obj Construct    ?ARG-VALUE...?
 *         $obj DefaultValue
 *         $obj Delete       PROPERTY
 *         $obj Enumerator
 *         $obj Get          PROPERTY
 *         $obj HasProperty  PROPERTY
 *         $obj Put          PROPERTY ARG-VALUE
 *         $obj Finalize
 *
 * Argument PROPERTY is a simple property name (i.e. "className"). 
 * VALUE is a typed javascript value. 
 *
 * Object resource management:
 *
 *     There are no resource management issues on the global object.
 *     The script must ensure that the specified command exists for the
 *     lifetime of the interpreter. The [Finalize] method is never
 *     called by the extension on the global object (not even when the
 *     interpreter is destroyed).
 *
 *     For all other objects, once the object is passed to javascript,
 *     javascript is in charge of deleting the object. The Tcl script
 *     must ensure that the command is valid until the javascript side
 *     calls the [Finalize] method. Of course, the command may become
 *     a no-op - that's a DOM detail....
 *
 *     An object is created by returning a value of one of the following 
 *     two forms from a [Call], [Construct] or [Get] method.
 *
 *         {object    COMMAND}
 *         {transient COMMAND}
 *
 *     Both forms create the same kinds of javascript object, but 
 *     the first initialises the object in "persistent" state
 *     the second in "transient" state. Objects in "transient" state
 *     are eligible for garbage collection once the SEE interpreter
 *     state contains no more references to it. Objects in "persistent"
 *     state are not garbage collected until the interpreter is deleted.
 *
 *     When an object in "transient" state is garbage collected,
 *     the [Finalize] method is invoked. After the interpreter is 
 *     deleted, [Finalize] will be (eventually) called for all 
 *     objects in "persistent" state.
 *
 *     The Tcl script may move an object from "persistent" to 
 *     "transient" state using the following command:
 *
 *         $interp make_transient COMMAND
 *
 *     And back again with
 *
 *         $interp make_peristent COMMAND
 *
 *     Command [set_state transient] may be called on any object in
 *     persistent state. But [set_state persistent] may be called only
 *     on objects passed from javascript to Tcl as command arguments.
 *     Calling [set_state persistent] on any other object throws
 *     a Tcl exception.
 */
